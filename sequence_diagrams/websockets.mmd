sequenceDiagram
    participant C as ğŸ–¥ï¸ Client
    participant S as ğŸ”Œ Server
    participant AI as ğŸ¤– GenAI Model

    Note over C, AI: ğŸ” Server Health Check (HTTP)
    C->>+S: GET /health
    S-->>-C: âœ… 200 OK<br/>ğŸ©º status, WebSocket info
    
    Note over C, AI: ğŸ”Œ WebSocket Connection
    C->>+S: WebSocket Handshake<br/>ğŸ“¡ ws://localhost:8000/ws
    S-->>C: ğŸ¤ Connection Accepted<br/>ğŸ”‘ connection_id
    S-->>-C: ğŸ“© WS: connected<br/>âœ… {connection_id, server_info}
    
    Note over C, AI: ğŸ†• Session Creation
    C->>S: ğŸ“© WS: create_session<br/>ğŸ”§ {type: "create_session"}
    S-->>C: ğŸ“© WS: session_created<br/>ğŸ”‘ {session_id, model}
    
    Note over C, AI: ğŸ”Œ Bidirectional Chat Stream
    rect rgb(240, 248, 255)
        C->>S: ğŸ“© WS: chat<br/>ğŸ“ {message, session_id}
        
        S-->>C: ğŸ“© WS: status<br/>ğŸ’­ "Generating response..."
        
        S->>+AI: generate_response<br/>ğŸ§  message + history
        
        S-->>C: ğŸ“© WS: response_start<br/>ğŸš€ {session_id, total_length}
        
        loop ğŸ”Œ Real-time Chunks
            AI-->>S: ğŸ“ response chunk
            S-->>C: ğŸ“© WS: chunk<br/>âœ¨ {text, chunk_number}
            Note over C: ğŸ–¨ï¸ Display chunk immediately
        end
        
        AI-->>-S: ğŸ response complete
        S-->>C: ğŸ“© WS: response_complete<br/>âœ… {total_chunks, processing_time}
    end
    
    Note over C, AI: ğŸ“Š Session Management (HTTP)
    C->>+S: GET /sessions/{session_id}
    S-->>-C: âœ… 200 OK<br/>ğŸ“‹ session info
    
    Note over C, AI: ğŸ”Œ WebSocket Disconnection
    C->>S: ğŸ“© WS: Close Connection
    S-->>C: ğŸ”š Connection Closed